<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; }
    ul { list-style-type: none; padding: 0; }
    li { margin-bottom: 1em; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
    .doc-meta { font-size: 0.95em; color: #444; }
    .actions { margin-top: 5px; }
    .actions a, .actions form { display: inline-block; margin-right: 10px; }
  </style>
</head>
<body>
  <h1>ğŸ“„ Uploaded Documents</h1>
  <p>
    <a href="/profile">My Profile</a> |
    <a href="/">Home</a> |
    <a href="/form/create">â• Submit New Form</a>
  </p>

  <!-- Filter Section -->
  <form method="get" action="/dashboard">
    <label>ğŸ”– Filter by tag:</label>
    <input type="text" name="tag" placeholder="e.g., diagnosis"
           value="{{ request.query_params.get('tag', '') }}">
    
    <label>ğŸ“… Filter by upload date:</label>
    <input type="date" name="date"
           value="{{ request.query_params.get('date', '') }}">
    
    <button type="submit">Apply Filters</button>
    <a href="/dashboard"><button type="button">Reset</button></a>
  </form>

  <!-- Documents List -->
  <ul>
    {% for doc in docs %}
      <li>
        <strong>ğŸ“ {{ doc.document_type }}</strong><br>
        <span class="doc-meta">
          Uploaded: {{ doc.upload_date }} <br>
          Tags: {{ doc.tags | join(", ") if doc.tags else "None" }}<br>
          Document ID: {{ doc.document_id }}
        </span>
        <div class="actions">
          <form method="post" action="/share">
            <input type="hidden" name="resource_id" value="{{ doc.document_id }}">
            <input type="hidden" name="resource_type" value="document">
            <input type="number" name="expires_in" placeholder="Expires in (hrs)" required min="1">
            <input type="text" name="shared_with" placeholder="Share with (username)">
            <input type="text" name="password" placeholder="Optional password">
            <button type="submit">ğŸ”— Share</button>
          </form>
        </div>
      </li>
    {% else %}
      <li>No documents found for the selected filters.</li>
    {% endfor %}
  </ul>

  <h2>ğŸ©º Submitted Medical Forms</h2>
  <ul>
    {% for form in forms %}
      <li>
        ğŸ‘¤ Name: {{ form.name }} |
        ğŸ‚ Age: {{ form.age }} |
        ğŸ—“ï¸ Submitted: {{ form.submitted_at }} |
        ğŸ“Œ Status: {{ form.status }}
        <div class="actions">
          <form method="post" action="/share">
            <input type="hidden" name="resource_id" value="{{ form._id }}">
            <input type="hidden" name="resource_type" value="form">
            <input type="number" name="expires_in" placeholder="Expires in (hrs)" required min="1">
            <input type="text" name="shared_with" placeholder="Share with (username)">
            <input type="text" name="password" placeholder="Optional password">
            <button type="submit">ğŸ”— Share</button>
          </form>
        </div>
      </li>
    {% else %}
      <li>No medical forms submitted yet.</li>
    {% endfor %}
  </ul>

</body>
</html>
